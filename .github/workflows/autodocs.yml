name: Auto-generated docs

on:
  pull_request:
    branches: [master, 'release/**']
    paths-ignore:
      - 'docs/**'
      - '**/*.md'

jobs:
  autodocs:
    if: github.event.label.name == 'autodocs'
    runs-on: ubuntu-18.04
    timeout-minutes: 20

    steps:
      - name: Check out code
        uses: actions/checkout@v2.4.0
        with:
          submodules: recursive

      - name: Install Dependencies
        run: sudo ./ci/autodocs.sh install_dependencies

      - name: Generate docs
        run: sudo ./ci/autodocs.sh generate_docs

      - name: Upload Autodocs
        uses: actions/upload-artifact@v2
        with:
          name: pdk.tar.gz
          path: |
            autodocs/output/
          retention-days: 3
